{"version":3,"file":"iblCdfGeneratorSceneComponent-D7XLVEop.esm.js","sources":["../../../../../dev/core/dist/Rendering/iblCdfGeneratorSceneComponent.js"],"sourcesContent":["import { Scene } from \"../scene\";\nimport { SceneComponentConstants } from \"../sceneComponent\";\nimport { IblCdfGenerator } from \"./iblCdfGenerator\";\nObject.defineProperty(Scene.prototype, \"iblCdfGenerator\", {\n    get: function () {\n        return this._iblCdfGenerator;\n    },\n    set: function (value) {\n        if (value) {\n            this._iblCdfGenerator = value;\n        }\n    },\n    enumerable: true,\n    configurable: true,\n});\nScene.prototype.enableIblCdfGenerator = function () {\n    if (this._iblCdfGenerator) {\n        return this._iblCdfGenerator;\n    }\n    this._iblCdfGenerator = new IblCdfGenerator(this);\n    if (!this._iblCdfGenerator.isSupported) {\n        this._iblCdfGenerator = null;\n        return null;\n    }\n    if (this.environmentTexture) {\n        this._iblCdfGenerator.iblSource = this.environmentTexture;\n    }\n    return this._iblCdfGenerator;\n};\nScene.prototype.disableIblCdfGenerator = function () {\n    if (!this._iblCdfGenerator) {\n        return;\n    }\n    this._iblCdfGenerator.dispose();\n    this._iblCdfGenerator = null;\n};\n/**\n * Defines the IBL CDF Generator scene component responsible for generating CDF maps for a given IBL.\n */\nexport class IblCdfGeneratorSceneComponent {\n    /**\n     * Creates a new instance of the component for the given scene\n     * @param scene Defines the scene to register the component in\n     */\n    constructor(scene) {\n        /**\n         * The component name helpful to identify the component in the list of scene components.\n         */\n        this.name = SceneComponentConstants.NAME_IBLCDFGENERATOR;\n        this._newIblObserver = null;\n        this.scene = scene;\n    }\n    /**\n     * Registers the component in a given scene\n     */\n    register() {\n        this._updateIblSource();\n        this._newIblObserver = this.scene.onEnvironmentTextureChangedObservable.add(this._updateIblSource.bind(this));\n    }\n    /**\n     * Rebuilds the elements related to this component in case of\n     * context lost for instance.\n     */\n    rebuild() {\n        // Nothing to do for this component\n    }\n    /**\n     * Disposes the component and the associated resources\n     */\n    dispose() {\n        this.scene.onEnvironmentTextureChangedObservable.remove(this._newIblObserver);\n    }\n    _updateIblSource() {\n        if (this.scene.iblCdfGenerator && this.scene.environmentTexture) {\n            this.scene.iblCdfGenerator.iblSource = this.scene.environmentTexture;\n        }\n    }\n}\nIblCdfGenerator._SceneComponentInitialization = (scene) => {\n    // Register the CDF generator component to the scene.\n    let component = scene._getComponent(SceneComponentConstants.NAME_IBLCDFGENERATOR);\n    if (!component) {\n        component = new IblCdfGeneratorSceneComponent(scene);\n        scene._addComponent(component);\n    }\n};\n//# sourceMappingURL=iblCdfGeneratorSceneComponent.js.map"],"names":[],"mappings":";;;;AAGA,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,SAAS,EAAE,iBAAiB,EAAE;AAC1D,IAAI,GAAG,EAAE,YAAY;AACrB,QAAQ,OAAO,IAAI,CAAC,gBAAgB;AACpC,KAAK;AACL,IAAI,GAAG,EAAE,UAAU,KAAK,EAAE;AAC1B,QAAQ,IAAI,KAAK,EAAE;AACnB,YAAY,IAAI,CAAC,gBAAgB,GAAG,KAAK;AACzC;AACA,KAAK;AACL,IAAI,UAAU,EAAE,IAAI;AACpB,IAAI,YAAY,EAAE,IAAI;AACtB,CAAC,CAAC;AACF,KAAK,CAAC,SAAS,CAAC,qBAAqB,GAAG,YAAY;AACpD,IAAI,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAC/B,QAAQ,OAAO,IAAI,CAAC,gBAAgB;AACpC;AACA,IAAI,IAAI,CAAC,gBAAgB,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC;AACrD,IAAI,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE;AAC5C,QAAQ,IAAI,CAAC,gBAAgB,GAAG,IAAI;AACpC,QAAQ,OAAO,IAAI;AACnB;AACA,IAAI,IAAI,IAAI,CAAC,kBAAkB,EAAE;AACjC,QAAQ,IAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,IAAI,CAAC,kBAAkB;AACjE;AACA,IAAI,OAAO,IAAI,CAAC,gBAAgB;AAChC,CAAC;AACD,KAAK,CAAC,SAAS,CAAC,sBAAsB,GAAG,YAAY;AACrD,IAAI,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;AAChC,QAAQ;AACR;AACA,IAAI,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE;AACnC,IAAI,IAAI,CAAC,gBAAgB,GAAG,IAAI;AAChC,CAAC;AACD;AACA;AACA;AACO,MAAM,6BAA6B,CAAC;AAC3C;AACA;AACA;AACA;AACA,IAAI,WAAW,CAAC,KAAK,EAAE;AACvB;AACA;AACA;AACA,QAAQ,IAAI,CAAC,IAAI,GAAG,uBAAuB,CAAC,oBAAoB;AAChE,QAAQ,IAAI,CAAC,eAAe,GAAG,IAAI;AACnC,QAAQ,IAAI,CAAC,KAAK,GAAG,KAAK;AAC1B;AACA;AACA;AACA;AACA,IAAI,QAAQ,GAAG;AACf,QAAQ,IAAI,CAAC,gBAAgB,EAAE;AAC/B,QAAQ,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,qCAAqC,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACrH;AACA;AACA;AACA;AACA;AACA,IAAI,OAAO,GAAG;AACd;AACA;AACA;AACA;AACA;AACA,IAAI,OAAO,GAAG;AACd,QAAQ,IAAI,CAAC,KAAK,CAAC,qCAAqC,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;AACrF;AACA,IAAI,gBAAgB,GAAG;AACvB,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,IAAI,IAAI,CAAC,KAAK,CAAC,kBAAkB,EAAE;AACzE,YAAY,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB;AAChF;AACA;AACA;AACA,eAAe,CAAC,6BAA6B,GAAG,CAAC,KAAK,KAAK;AAC3D;AACA,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,aAAa,CAAC,uBAAuB,CAAC,oBAAoB,CAAC;AACrF,IAAI,IAAI,CAAC,SAAS,EAAE;AACpB,QAAQ,SAAS,GAAG,IAAI,6BAA6B,CAAC,KAAK,CAAC;AAC5D,QAAQ,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC;AACtC;AACA,CAAC;;;;"}