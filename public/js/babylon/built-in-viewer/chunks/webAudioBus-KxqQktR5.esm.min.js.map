{"version":3,"file":"webAudioBus-KxqQktR5.esm.min.js","sources":["../../../../../dev/core/dist/AudioV2/abstractAudio/audioBus.js","../../../../../dev/core/dist/AudioV2/webAudio/webAudioBus.js"],"sourcesContent":["import { AbstractAudioBus } from \"./abstractAudioBus\";\n/**\n * Abstract class for an audio bus that has spatial audio and stereo output capabilities.\n *\n * Instances of this class can be connected to other audio buses.\n *\n * Audio buses are created by the {@link CreateAudioBusAsync} function.\n */\nexport class AudioBus extends AbstractAudioBus {\n    constructor(name, engine) {\n        super(name, engine);\n        this._outBus = null;\n        this._onOutBusDisposed = () => {\n            this.outBus = this.engine.defaultMainBus;\n        };\n    }\n    /**\n     * The output bus of the audio bus. Defaults to the audio engine's default main bus.\n     */\n    get outBus() {\n        return this._outBus;\n    }\n    set outBus(outBus) {\n        if (this._outBus === outBus) {\n            return;\n        }\n        if (this._outBus) {\n            this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed);\n            if (!this._disconnect(this._outBus)) {\n                throw new Error(\"Disconnect failed\");\n            }\n        }\n        this._outBus = outBus;\n        if (this._outBus) {\n            this._outBus.onDisposeObservable.add(this._onOutBusDisposed);\n            if (!this._connect(this._outBus)) {\n                throw new Error(\"Connect failed\");\n            }\n        }\n    }\n    /**\n     * Releases associated resources.\n     */\n    dispose() {\n        super.dispose();\n        this._outBus = null;\n    }\n}\n//# sourceMappingURL=audioBus.js.map","import { AudioBus } from \"../abstractAudio/audioBus\";\nimport { _HasSpatialAudioOptions } from \"../abstractAudio/subProperties/abstractSpatialAudio\";\nimport { _StereoAudio } from \"../abstractAudio/subProperties/stereoAudio\";\nimport { _WebAudioBusAndSoundSubGraph } from \"./subNodes/webAudioBusAndSoundSubGraph\";\nimport { _SpatialWebAudio } from \"./subProperties/spatialWebAudio\";\n/** @internal */\nexport class _WebAudioBus extends AudioBus {\n    /** @internal */\n    constructor(name, engine, options) {\n        super(name, engine);\n        this._spatial = null;\n        this._spatialAutoUpdate = true;\n        this._spatialMinUpdateTime = 0;\n        this._stereo = null;\n        if (typeof options.spatialAutoUpdate === \"boolean\") {\n            this._spatialAutoUpdate = options.spatialAutoUpdate;\n        }\n        if (typeof options.spatialMinUpdateTime === \"number\") {\n            this._spatialMinUpdateTime = options.spatialMinUpdateTime;\n        }\n        this._subGraph = new _WebAudioBus._SubGraph(this);\n    }\n    /** @internal */\n    async _initAsync(options) {\n        if (options.outBus) {\n            this.outBus = options.outBus;\n        }\n        else {\n            await this.engine.isReadyPromise;\n            this.outBus = this.engine.defaultMainBus;\n        }\n        await this._subGraph.initAsync(options);\n        if (_HasSpatialAudioOptions(options)) {\n            this._initSpatialProperty();\n        }\n        this.engine._addNode(this);\n    }\n    /** @internal */\n    dispose() {\n        super.dispose();\n        this._spatial = null;\n        this._stereo = null;\n        this.engine._removeNode(this);\n    }\n    /** @internal */\n    get _inNode() {\n        return this._subGraph._inNode;\n    }\n    /** @internal */\n    get _outNode() {\n        return this._subGraph._outNode;\n    }\n    /** @internal */\n    get spatial() {\n        if (this._spatial) {\n            return this._spatial;\n        }\n        return this._initSpatialProperty();\n    }\n    /** @internal */\n    get stereo() {\n        return this._stereo ?? (this._stereo = new _StereoAudio(this._subGraph));\n    }\n    /** @internal */\n    getClassName() {\n        return \"_WebAudioBus\";\n    }\n    _connect(node) {\n        const connected = super._connect(node);\n        if (!connected) {\n            return false;\n        }\n        if (node._inNode) {\n            this._outNode?.connect(node._inNode);\n        }\n        return true;\n    }\n    _disconnect(node) {\n        const disconnected = super._disconnect(node);\n        if (!disconnected) {\n            return false;\n        }\n        if (node._inNode) {\n            this._outNode?.disconnect(node._inNode);\n        }\n        return true;\n    }\n    _initSpatialProperty() {\n        if (!this._spatial) {\n            this._spatial = new _SpatialWebAudio(this._subGraph, this._spatialAutoUpdate, this._spatialMinUpdateTime);\n        }\n        return this._spatial;\n    }\n}\n_WebAudioBus._SubGraph = class extends _WebAudioBusAndSoundSubGraph {\n    get _downstreamNodes() {\n        return this._owner._downstreamNodes ?? null;\n    }\n    get _upstreamNodes() {\n        return this._owner._upstreamNodes ?? null;\n    }\n};\n//# sourceMappingURL=webAudioBus.js.map"],"names":["AudioBus","AbstractAudioBus","constructor","name","engine","super","this","_outBus","_onOutBusDisposed","outBus","defaultMainBus","onDisposeObservable","removeCallback","_disconnect","Error","add","_connect","dispose","_WebAudioBus","options","_spatial","_spatialAutoUpdate","_spatialMinUpdateTime","_stereo","spatialAutoUpdate","spatialMinUpdateTime","_subGraph","_SubGraph","_initAsync","isReadyPromise","initAsync","_HasSpatialAudioOptions","_initSpatialProperty","_addNode","_removeNode","_inNode","_outNode","spatial","stereo","_StereoAudio","getClassName","node","connect","disconnect","_SpatialWebAudio","_WebAudioBusAndSoundSubGraph","_downstreamNodes","_owner","_upstreamNodes"],"mappings":"2QAQO,MAAMA,UAAiBC,EAC1B,WAAAC,CAAYC,EAAMC,GACdC,MAAMF,EAAMC,GACZE,KAAKC,QAAU,KACfD,KAAKE,kBAAoB,KACrBF,KAAKG,OAASH,KAAKF,OAAOM,eAEtC,CAII,UAAID,GACA,OAAOH,KAAKC,OACpB,CACI,UAAIE,CAAOA,GACP,GAAIH,KAAKC,UAAYE,EAArB,CAGA,GAAIH,KAAKC,UACLD,KAAKC,QAAQI,oBAAoBC,eAAeN,KAAKE,oBAChDF,KAAKO,YAAYP,KAAKC,UACvB,MAAM,IAAIO,MAAM,qBAIxB,GADAR,KAAKC,QAAUE,EACXH,KAAKC,UACLD,KAAKC,QAAQI,oBAAoBI,IAAIT,KAAKE,oBACrCF,KAAKU,SAASV,KAAKC,UACpB,MAAM,IAAIO,MAAM,iBAXhC,CAcA,CAII,OAAAG,GACIZ,MAAMY,UACNX,KAAKC,QAAU,IACvB,ECxCO,MAAMW,UAAqBlB,EAE9B,WAAAE,CAAYC,EAAMC,EAAQe,GACtBd,MAAMF,EAAMC,GACZE,KAAKc,SAAW,KAChBd,KAAKe,oBAAqB,EAC1Bf,KAAKgB,sBAAwB,EAC7BhB,KAAKiB,QAAU,KAC0B,kBAA9BJ,EAAQK,oBACflB,KAAKe,mBAAqBF,EAAQK,mBAEM,iBAAjCL,EAAQM,uBACfnB,KAAKgB,sBAAwBH,EAAQM,sBAEzCnB,KAAKoB,UAAY,IAAIR,EAAaS,UAAUrB,KACpD,CAEI,gBAAMsB,CAAWT,GACTA,EAAQV,OACRH,KAAKG,OAASU,EAAQV,cAGhBH,KAAKF,OAAOyB,eAClBvB,KAAKG,OAASH,KAAKF,OAAOM,sBAExBJ,KAAKoB,UAAUI,UAAUX,GAC3BY,EAAwBZ,IACxBb,KAAK0B,uBAET1B,KAAKF,OAAO6B,SAAS3B,KAC7B,CAEI,OAAAW,GACIZ,MAAMY,UACNX,KAAKc,SAAW,KAChBd,KAAKiB,QAAU,KACfjB,KAAKF,OAAO8B,YAAY5B,KAChC,CAEI,WAAI6B,GACA,OAAO7B,KAAKoB,UAAUS,OAC9B,CAEI,YAAIC,GACA,OAAO9B,KAAKoB,UAAUU,QAC9B,CAEI,WAAIC,GACA,OAAI/B,KAAKc,SACEd,KAAKc,SAETd,KAAK0B,sBACpB,CAEI,UAAIM,GACA,OAAOhC,KAAKiB,UAAYjB,KAAKiB,QAAU,IAAIgB,EAAajC,KAAKoB,WACrE,CAEI,YAAAc,GACI,MAAO,cACf,CACI,QAAAxB,CAASyB,GAEL,QADkBpC,MAAMW,SAASyB,KAI7BA,EAAKN,SACL7B,KAAK8B,UAAUM,QAAQD,EAAKN,UAEzB,EACf,CACI,WAAAtB,CAAY4B,GAER,QADqBpC,MAAMQ,YAAY4B,KAInCA,EAAKN,SACL7B,KAAK8B,UAAUO,WAAWF,EAAKN,UAE5B,EACf,CACI,oBAAAH,GAII,OAHK1B,KAAKc,WACNd,KAAKc,SAAW,IAAIwB,EAAiBtC,KAAKoB,UAAWpB,KAAKe,mBAAoBf,KAAKgB,wBAEhFhB,KAAKc,QACpB,EAEAF,EAAaS,UAAY,cAAckB,EACnC,oBAAIC,GACA,OAAOxC,KAAKyC,OAAOD,kBAAoB,IAC/C,CACI,kBAAIE,GACA,OAAO1C,KAAKyC,OAAOC,gBAAkB,IAC7C"}