import{GLTFLoader as e,ArrayItem as t}from"./glTFLoader-ASl42hNE.esm.min.js";import{p as s,bK as o,bJ as r}from"./index-BeBPThKX.esm.min.js";import"./bone-4zSTwM2L.esm.min.js";import"./skeleton-BM6jc2S2.esm.min.js";import"./rawTexture-OHFtV4yv.esm.min.js";import"./assetContainer-C4iCgc7c.esm.min.js";import"./objectModelMapping-C_2yKgOV.esm.min.js";let n=0,a=null;class i{static get Default(){return i._Default||(i._Default=new i),i._Default}constructor(){const e=i.Configuration.decoder;this._decoderModulePromise=s.LoadBabylonScriptAsync(e.url).then((()=>MeshoptDecoder.ready))}dispose(){delete this._decoderModulePromise}async decodeGltfBufferAsync(e,t,s,o,r){await this._decoderModulePromise,0===n&&(MeshoptDecoder.useWorkers(1),n=1);const i=await MeshoptDecoder.decodeGltfBufferAsync(t,s,e,o,r);return null!==a&&clearTimeout(a),a=setTimeout((()=>{MeshoptDecoder.useWorkers(0),n=0,a=null}),1e3),i}}i.Configuration={decoder:{url:`${s._DefaultCdnUrl}/meshopt_decoder.js`}},i._Default=null;const d="EXT_meshopt_compression";class l{constructor(e){this.name=d,this.enabled=e.isExtensionUsed(d),this._loader=e}dispose(){this._loader=null}loadBufferViewAsync(s,o){return e.LoadExtensionAsync(s,o,this.name,(async(e,r)=>{const n=o;if(n._meshOptData)return await n._meshOptData;const a=t.Get(`${s}/buffer`,this._loader.gltf.buffers,r.buffer);return n._meshOptData=this._loader.loadBufferAsync(`/buffers/${a.index}`,a,r.byteOffset||0,r.byteLength).then((async e=>await i.Default.decodeGltfBufferAsync(e,r.count,r.byteStride,r.mode,r.filter))),await n._meshOptData}))}}o(d),r(d,!0,(e=>new l(e)));export{l as EXT_meshopt_compression};
//# sourceMappingURL=EXT_meshopt_compression-a_uWVzNq.esm.min.js.map
